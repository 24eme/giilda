#!/bin/bash

echo "#MOUVEMENT ; type document ; identifiant document ; campagne ; periode ; dococument id ;  produit_hash du mouvement ; type de mouvement ; numero vrac du mouvement ; detail identifiant ; libelle produit ;  libelle type ; volume mouvement ; vrac destinataire ; detail ;  date ; mouvement version ;";
curl http://localhost:5984/vinsdeloire/_design/mouvement/_view/consultation | sed 's/.*"key":\[/MOUVEMENT;/' | sed 's/\],"value":\[/,/' | sed 's/\]\},*//' | grep '^MOUVEMENT;"' | sed 's/,/;/g' | sed 's/\r*$/;/' | sed 's/null//g'
echo "#CONTRAT ; SOLDE ; identifiant document ; identifiant acheteur; nom acheteur ; identifiant vendeur; non vendeur ;identifiant courtier;nom courtier;type de vente (vin vrac, vin conditionne, raisin, mout); hash produit ;produit nom; volume propose; volume enleve ; prix unitaire ; contrat interne (oui, non)"
curl http://localhost:5984/vinsdeloire/_design/vrac/_view/history | sed 's/.*"value":\[/CONTRAT;/' | sed 's/\],"value":\[/,/' | sed 's/\]\},*//' | grep '^CONTRAT;"SOL' | sed 's/,/;/g' | sed 's/\r*$/;/' | sed 's/null//g'
echo "#ETABLISSEMENT ; doc.interpro  doc.famille ; doc._id ;  doc.nom ;   doc.identifiant ;  doc.raison_sociale ;   doc.siret ;   doc.cvi ;   doc.siege.commune ; doc.siege.code_postal"
curl http://localhost:5984/vinsdeloire/_design/etablissement/_view/all | sed 's/.*"key":\["INTERPRO-inter-loire",/ETABLISSEMENT;/' | sed 's/\],"value":\[*/,/' | sed 's/\]*\},*//' | grep '^ETABLISSEMENT;"' | sed 's/,/;/g' | sed 's/\r*$/;/' | sed 's/null//g'
