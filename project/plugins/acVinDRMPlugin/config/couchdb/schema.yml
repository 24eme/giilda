
DRM:
  definition:
    fields:
      _id: {  }
      _rev: {  }
      _attachments:
        type: collection
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  '*': { }
      type: {  }
      region: {  }
      editeurs:
        type: array_collection
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  compte: {  }
                  nom: {  }
                  prenom: {  }
                  date_modification: {  }
      apurement_possible: {  }
      raison_rectificative: {  }
      etape: {  }
      campagne: {  }
      type_creation: {  }
      email_transmission: {  }
      periode: {  }
      teledeclare: { }
      precedente: {  }
      version: {  }
      numero_archive: {  }
      droits:
        type: collection
        definition:
          fields:
            douane:
              class: DRMDroits
              type: collection
              definition:
                fields:
                  '*':
                    class: DRMDroit
                    type: collection
                    definition:
                      fields:
                        volume_taxe: { type: float }
                        volume_reintegre: { type: float }
                        taux: {  }
                        code: {  }
                        libelle: {  }
                        total: { type: float }
                        report: { type: float }
                        cumul: { type: float }
            cvo:
              class: DRMDroits
              type: collection
              definition:
                fields:
                  '*':
                    class: DRMDroit
                    type: collection
                    definition:
                      fields:
                        volume_taxe: { type: float }
                        volume_reintegre: { type: float }
                        taux: { type: float }
                        code: {  }
                        libelle: {  }
                        total: { type: float }
                        report: { type: float }
                        cumul: { type: float }
      declaration:
        class: DRMDeclaration
        inheritance: _DRMTotal
        type: collection
        definition:
          fields:
            total_debut_mois: { type: float }
            total_entrees: { type: float }
            total_entrees_revendique: { type: float }
            total_recolte:  { type: float }
            total_sorties: { type: float }
            total_sorties_revendique: { type: float }
            total_facturable: { type: float }
            total_revendique: { type: float }
            total: { type: float }
            certifications:
              type: collection
              definition:
                fields:
                  '*':
                    # CERTIFICATION
                    class: DRMCertification
                    inheritance: _DRMTotal
                    type: collection
                    definition:
                      fields:
                        total_debut_mois: { type: float }
                        total_entrees: { type: float }
                        total_entrees_revendique: { type: float }
                        total_recolte:  { type: float }
                        total_sorties: { type: float }
                        total_sorties_revendique: { type: float }
                        total_facturable: { type: float }
                        total_revendique: { type: float }
                        total: { type: float }
                        genres:
                          type: collection
                          definition:
                            fields:
                              '*':
                                # GENRE
                                class: DRMGenre
                                inheritance: _DRMTotal
                                type: collection
                                definition:
                                  fields:
                                    total_debut_mois: { type: float }
                                    total_entrees: { type: float }
                                    total_entrees_revendique: { type: float }
                                    total_recolte:  { type: float }
                                    total_sorties: { type: float }
                                    total_sorties_revendique: { type: float }
                                    total_facturable: { type: float }
                                    total_revendique: { type: float }
                                    total: { type: float }
                                    appellations:
                                      type: collection
                                      definition:
                                        fields:
                                          '*':
                                            # APPELLATION
                                            class: DRMAppellation
                                            inheritance: _DRMTotal
                                            type: collection
                                            definition:
                                              fields:
                                                total_debut_mois: { type: float }
                                                total_entrees: { type: float }
                                                total_entrees_revendique: { type: float }
                                                total_recolte:  { type: float }
                                                total_sorties: { type: float }
                                                total_sorties_revendique: { type: float }
                                                total_facturable: { type: float }
                                                total_revendique: { type: float }
                                                total: { type: float }
                                                mentions:
                                                  type: collection
                                                  definition:
                                                    fields:
                                                      '*':
                                                        # MENTION
                                                        class: DRMMention
                                                        inheritance: _DRMTotal
                                                        type: collection
                                                        definition:
                                                          fields:
                                                            total_debut_mois: { type: float }
                                                            total_entrees: { type: float }
                                                            total_entrees_revendique: { type: float }
                                                            total_recolte:  { type: float }
                                                            total_sorties: { type: float }
                                                            total_sorties_revendique: { type: float }
                                                            total_facturable: { type: float }
                                                            total_revendique: { type: float }
                                                            total: { type: float }
                                                            lieux:
                                                              type: collection
                                                              definition:
                                                                fields:
                                                                  '*':
                                                                    # LIEU
                                                                    class: DRMLieu
                                                                    inheritance: _DRMTotal
                                                                    type: collection
                                                                    definition:
                                                                      fields:
                                                                        total_debut_mois: { type: float }
                                                                        total_entrees: { type: float }
                                                                        total_entrees_revendique: { type: float }
                                                                        total_recolte:  { type: float }
                                                                        total_sorties: { type: float }
                                                                        total_sorties_revendique: { type: float }
                                                                        total_facturable: { type: float }
                                                                        total_revendique: { type: float }
                                                                        total: { type: float }
                                                                        couleurs:
                                                                          type: collection
                                                                          definition:
                                                                            fields:
                                                                              '*':
                                                                                # COULEUR
                                                                                class: DRMCouleur
                                                                                inheritance: _DRMTotal
                                                                                type: collection
                                                                                definition:
                                                                                  fields:
                                                                                    total_debut_mois: { type: float }
                                                                                    total_entrees: { type: float }
                                                                                    total_entrees_revendique: { type: float }
                                                                                    total_recolte:  { type: float }
                                                                                    total_sorties: { type: float }
                                                                                    total_sorties_revendique: { type: float }
                                                                                    total_facturable: { type: float }
                                                                                    total_revendique: { type: float }
                                                                                    total: { type: float }
                                                                                    cepages:
                                                                                      type: collection
                                                                                      definition:
                                                                                        fields:
                                                                                          '*':
                                                                                            # CEPAGE
                                                                                            class: DRMCepage
                                                                                            inheritance: _DRMTotal
                                                                                            type: collection
                                                                                            definition:
                                                                                              fields:
                                                                                                total_debut_mois: { type: float }
                                                                                                total_entrees: { type: float }
                                                                                                total_entrees_revendique: { type: float }
                                                                                                total_recolte:  { type: float }
                                                                                                total_sorties: { type: float }
                                                                                                total_sorties_revendique: { type: float }
                                                                                                total_facturable: { type: float }
                                                                                                total_revendique: { type: float }
                                                                                                total: { type: float }
                                                                                                no_movements: { required: false } # Plus utilisé
                                                                                                edited: { required: false } # Plus utilisé
                                                                                                '*':
                                                                                                  type: collection
                                                                                                  class: DRMDetails
                                                                                                  definition:
                                                                                                    fields:
                                                                                                      '*':
                                                                                                        class: DRMDetail
                                                                                                        type: collection
                                                                                                        definition:
                                                                                                          fields:
                                                                                                            no_movements: { required: false }
                                                                                                            edited: { required: false }
                                                                                                            denomination_complementaire: { }
                                                                                                            pas_de_mouvement_check: { type: integer }
                                                                                                            total_debut_mois: { type: float }
                                                                                                            total_entrees: { type: float }
                                                                                                            total_entrees_revendique: { type: float }
                                                                                                            total_recolte:  { type: float }
                                                                                                            total_sorties: { type: float }
                                                                                                            total_sorties_revendique: { type: float }
                                                                                                            total_facturable: { type: float }
                                                                                                            total_revendique: { type: float }
                                                                                                            total: { type: float }
                                                                                                            produit_libelle: {  }
                                                                                                            cvo: {type: float}
                                                                                                            replacement_date: { required: false }
                                                                                                            code_inao: { }
                                                                                                            observations: { required: false }
                                                                                                            tav: { required: false }
                                                                                                            labels:
                                                                                                              type: array_collection
                                                                                                              definition:
                                                                                                                fields:
                                                                                                                  '*': {  }
                                                                                                            label_supplementaire: {  }
                                                                                                            millesimes:
                                                                                                              type: array_collection
                                                                                                              definition:
                                                                                                                fields:
                                                                                                                  '*': {  }
                                                                                                            cvo:
                                                                                                              type: collection
                                                                                                              class: DRMDetailDroit
                                                                                                              definition:
                                                                                                                fields:
                                                                                                                  taux: { type: float }
                                                                                                                  volume_taxable: { type: float }
                                                                                                            stocks_debut:
                                                                                                              type: collection
                                                                                                              class: DRMDetailNoeud
                                                                                                              definition:
                                                                                                                fields:
                                                                                                                  '*': { type: float }
                                                                                                            entrees:
                                                                                                              type: collection
                                                                                                              class: DRMDetailNoeud
                                                                                                              definition:
                                                                                                                fields:
                                                                                                                  '*': { type: float }

                                                                                                            sorties:
                                                                                                              type: collection
                                                                                                              class: DRMDetailNoeud
                                                                                                              definition:
                                                                                                                fields:
                                                                                                                  '*': { type: float }
                                                                                                                  vrac_details:
                                                                                                                    class: DRMESDetails
                                                                                                                    type:  collection
                                                                                                                    required: false
                                                                                                                    definition:
                                                                                                                      fields:
                                                                                                                        '*':
                                                                                                                          type: collection
                                                                                                                          class: DRMESDetailVrac
                                                                                                                          definition:
                                                                                                                            fields:
                                                                                                                              identifiant: {  }
                                                                                                                              volume: { type: float }
                                                                                                                              date_enlevement: {  }
                                                                                                                              numero_document: {  }
                                                                                                                              type_document: {  }
                                                                                                                  bouteillenue_details:
                                                                                                                    class: DRMESDetails
                                                                                                                    type:  collection
                                                                                                                    required: false
                                                                                                                    definition:
                                                                                                                      fields:
                                                                                                                        '*':
                                                                                                                          type: collection
                                                                                                                          class: DRMESDetailVrac
                                                                                                                          definition:
                                                                                                                            fields:
                                                                                                                              identifiant: {  }
                                                                                                                              volume: { type: float }
                                                                                                                              date_enlevement: {  }
                                                                                                                              numero_document: {  }
                                                                                                                              type_document: {  }
                                                                                                                  creationvrac_details:
                                                                                                                    class: DRMESDetails
                                                                                                                    type:  collection
                                                                                                                    required: false
                                                                                                                    definition:
                                                                                                                      fields:
                                                                                                                        '*':
                                                                                                                          type: collection
                                                                                                                          class: DRMESDetailCreationVrac
                                                                                                                          definition:
                                                                                                                            fields:
                                                                                                                              identifiant: {  }
                                                                                                                              volume: { type: float }
                                                                                                                              prixhl: { type: float }
                                                                                                                              acheteur: {  }
                                                                                                                              date_enlevement: {  }
                                                                                                                              numero_document: {  }
                                                                                                                              type_document: {  }
                                                                                                                              type_contrat: {  }
                                                                                                                              numero_archive: {  }
                                                                                                                  creationvractirebouche_details:
                                                                                                                    class: DRMESDetails
                                                                                                                    type:  collection
                                                                                                                    required: false
                                                                                                                    definition:
                                                                                                                      fields:
                                                                                                                        '*':
                                                                                                                          type: collection
                                                                                                                          class: DRMESDetailCreationVrac
                                                                                                                          definition:
                                                                                                                            fields:
                                                                                                                              identifiant: {  }
                                                                                                                              volume: { type: float }
                                                                                                                              prixhl: { type: float }
                                                                                                                              acheteur: {  }
                                                                                                                              date_enlevement: {  }
                                                                                                                              numero_document: {  }
                                                                                                                              type_document: {  }
                                                                                                                              type_contrat: {  }
                                                                                                                              numero_archive: {  }
                                                                                                                  exporttaxe_details:
                                                                                                                    class: DRMESDetails
                                                                                                                    type:  collection
                                                                                                                    required: false
                                                                                                                    definition:
                                                                                                                      fields:
                                                                                                                        '*':
                                                                                                                          type: collection
                                                                                                                          class: DRMESDetailExport
                                                                                                                          definition:
                                                                                                                            fields:
                                                                                                                              identifiant: {  }
                                                                                                                              volume: { type: float }
                                                                                                                              date_enlevement: {  }
                                                                                                                              numero_document: {  }
                                                                                                                              type_document: {  }
                                                                                                                  export_details:
                                                                                                                    class: DRMESDetails
                                                                                                                    type:  collection
                                                                                                                    required: false
                                                                                                                    definition:
                                                                                                                      fields:
                                                                                                                        '*':
                                                                                                                          type: collection
                                                                                                                          class: DRMESDetailExport
                                                                                                                          definition:
                                                                                                                            fields:
                                                                                                                              identifiant: {  }
                                                                                                                              volume: { type: float }
                                                                                                                              date_enlevement: {  }
                                                                                                                              numero_document: {  }
                                                                                                                              type_document: {  }
                                                                                                                  transfertsrecolte_details:
                                                                                                                      class: DRMESDetails
                                                                                                                      type:  collection
                                                                                                                      required: false
                                                                                                                      definition:
                                                                                                                        fields:
                                                                                                                          '*':
                                                                                                                            type: collection
                                                                                                                            class: DRMESDetailAlcoolPur
                                                                                                                            definition:
                                                                                                                              fields:
                                                                                                                                identifiant: {  }
                                                                                                                                volume: { type: float }
                                                                                                            stocks_fin:
                                                                                                              type: collection
                                                                                                              class: DRMDetailNoeud
                                                                                                              definition:
                                                                                                                fields:
                                                                                                                  '*': { type: float }
      declarant:
        type: collection
        definition:
          fields:
            nom: {  }
            raison_sociale: {  }
            cvi: {  }
            num_accise: {  required: false } # A SUPPRIMER
            no_accises: {   }
            num_tva_intracomm: {  required: false } # A SUPPRIMER
            adresse: {  }
            commune: {  }
            code_postal: {   }
            region: {  }
            adresse_compta: {  }
            caution: { }
            raison_sociale_cautionneur: { }
            famille: {  }
      societe:
        type: collection
        definition:
          fields:
            raison_sociale: { }
            siret: { }
            email: { }
            telephone: { }
            fax: { }
            adresse: { }
            commune: { }
            code_postal: { }
            paiement_douane_moyen: { }
            paiement_douane_frequence: { }
      declaratif:
        class: DRMDeclaratif
        type: collection
        definition:
          fields:
            defaut_apurement: { type: integer }
            daa:
              type: collection
              required: false
              definition:
                fields:
                  debut: { type: integer }
                  fin: { type: integer }
                  nb: {type: integer, required: false}
            dsa:
              type: collection
              required: false
              definition:
                fields:
                  debut: { type: integer }
                  fin: { type: integer }
                  nb: {type: integer, required: false }
            statistiques:
              type: collection
              definition:
                fields:
                  jus: { type: float }
                  mcr: { type: float }
                  vinaigre: { type: float }
            adhesion_emcs_gamma: { type: integer, required: false }
            paiement:
              type: collection
              definition:
                fields:
                  douane:
                    class: DRMPaiement
                    type: collection
                    definition:
                      fields:
                        frequence: {  }
                        moyen: {  }
                  cvo:
                    class: DRMPaiement
                    type: collection
                    definition:
                      fields:
                        frequence: {  }
                        moyen: {  }
            caution:
              type: collection
              definition:
                fields:
                  dispense: { type: integer }
                  organisme: {  }
            statistiques:
              type: collection
              definition:
                fields:
                  jus: { type: float }
                  mcr: { type: float }
                  vinaigre: { type: float }
      identifiant: {  }
      mode_de_saisie: {  }
      commentaire: {}
      interpros:
        type: array_collection
        definition:
          fields:
            '*': {  }
      valide:
        type: collection
        definition:
          fields:
            date_saisie: {  }
            date_signee: {  }
            identifiant: {  }
            status: { required: false }
            statut: { }
      douane:
        type: collection
        definition:
          fields:
            service: {  }
            envoi: {  }
            accuse: {  }
      mouvements:
        type: collection
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  '*':
                    class: DRMMouvement
                    inheritance: Mouvement
                    type: collection
                    definition:
                      fields:
                        categorie: {  }
                        denomination_complementaire: {  }
                        produit_hash: {  }
                        produit_libelle: {  }
                        type_hash: {  }
                        type_drm: {  }
                        type_drm_libelle: {  }
                        type_libelle: {  }
                        vrac_numero: {  }
                        vrac_destinataire: {  }
                        detail_identifiant: {  }
                        detail_libelle: {  }
                        volume: { type: float }
                        cvo: { type: float }
                        facture: { type: integer }
                        facturable: { type: integer }
                        coefficient_facturation: { type: integer, required: false }
                        region: { }
                        region_destinataire: { }
                        date: {  }
                        date_version: {  }
                        version: {  }
      crds:
        type: collection
        class: DRMCrdsRegime
        required: false
        definition:
          fields:
            '*':
              type: collection
              class: DRMCrds
              definition:
                fields:
                  '*':
                    type: collection
                    class: DRMCrd
                    definition:
                      fields:
                        genre: {  }
                        stock_debut: {  }
                        stock_fin: {  }
                        couleur: {  }
                        centilitrage: {  }
                        detail_libelle: {  }
                        entrees_achats: {  }
                        entrees_retours: {  }
                        entrees_excedents: {  }
                        sorties_utilisations: {  }
                        sorties_destructions: {  }
                        sorties_manquants: {  }
      favoris:
        type: collection
        required: false
        class: DRMFavoris
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  '*':
                    type: collection
                    definition:
                      fields:
                        '*': { }
      documents_annexes:
        type: collection
        required: true
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  'debut': { }
                  'fin': { }
                  'nb' : { }
      releve_non_apurement:
        type: collection
        class: DRMNonApurement
        required: false
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  'numero_document': { }
                  'date_emission': { }
                  'numero_accise': { }
      observations: { }
      quantite_sucre: { }
      transmission_douane:
        type: collection
        required: false
        definition:
          fields:
            'xml': string
            'success': boolean
            'horodatage': string
            'id_declaration': string
            'coherente': boolean
            diff: { required: false }

CSVDRM:
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {  }
      _attachments:
        type: collection
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  content_type: { }
                  revpos: { }
                  length: { }
                  stub: { }
                  digest: { }
      identifiant: {  }
      periode: {  }
      statut: {  }
      erreurs:
        type: collection
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  num_ligne: { type: integer }
                  csv_erreur: { }
                  diagnostic: { }
